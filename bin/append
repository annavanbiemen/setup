#!/bin/bash

# Exit on errors
set -euo pipefail

# Import libraries
source "$(dirname "$(dirname "$(realpath "${BASH_SOURCE[0]}")")")/lib/standard.sh"
source "$(dirname "$(dirname "$(realpath "${BASH_SOURCE[0]}")")")/lib/config.sh"

# Append missing lines to file
#
# Usage: append [options] <file> <line> [<line> ...]
#
# Options:
#   -d, --debug    Show debug information
#   -h, --help     Show help information
#   -v, --version  Show version information
#
# Arguments:
#   file      File to append to
#   line ...  Lines to append (unless already present) one by one
main() {
    # Parse arguments
    arguments=()
    while [[ "$#" -gt 0 ]]; do
        case "$1" in
        -d | --debug)
            standard::debug
            ;;
        -h | --help)
            standard::help main
            return
            ;;
        -v | --version)
            standard::version
            return
            ;;
        -*)
            standard::raise "Unknown option passed: $1"
            ;;
        *) arguments+=("$1") ;;
        esac
        shift
    done

    # Append lines to file
    config::add "${arguments[@]}"
}

# Invoke main entrypoint
main "$@"
